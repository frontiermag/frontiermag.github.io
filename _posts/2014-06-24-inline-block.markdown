---
layout: post
title: "Инлайн-блоки как светлое настоящее"
tag: "вёрстка"
short: "Будет полезно тем, у кого мало опыта с инлайн-блоками; всем прочим — только ностальгия."
published: true
---
Пока flexbox ещё за Горами Реализаций, inline-block — надёжный инструмент верстальщика.

<abbr title="Too long; did not read — (англ.) многабукфниасилил">TL;DR</abbr>: элемент со свойством `display: inline-block` рендерится как блок, но при этом позиционируется в строке.

История
-------

Помимо квадратуры круга и простого доказательства Великой теоремы Ферма, перед человечеством с момента создания интернета стоял важный вопрос — как отцентрировать блок по вертикали, если высота этого блока заранее неизвестна (ведь 
если известна, то <abbr title="top: 50%; margin-top: -(height/2)px">всё просто</abbr>)

Каждый решал этот вопрос в меру своей испорченности — кто возвращал макет дизайнерам с пометкой «no way», кто забивал на семантику и верстал таблицами, а кто делал получше, применяя `display: table` к `<div>`. [Хитрая техника](http://www.smashingmagazine.com/2013/08/09/absolute-horizontal-vertical-centering-css/) c абсолютным позиционированием не была ещё сильно известна.

И тут inline-block вступает в игру. Он нормально поддерживается всеми браузерами (IE — с восьмой версии), довольно семантичен и прост. Вертикальное центрирование — лишь одно из многих применений.

И для его реализации есть два метода, в зависимости от того, известна ли высота родительского

* Выставляем line-height родительского блока равным высоте, а самому блоку сбрасываем line-height и присваиваем vertical-align: middle.
* Вставляем внутри родительского блока рядом ещё один inline-block с `height: 100%` и `vertical-align: middle`. Таким образом, line-height родительского блока всё равно становится равной его высоте и мы возвращаемся к предыдущему варианту без необходимости сбрасывать line-height.

Какой из вариантов лучше — зависит от ситуации, порой сбрасывать line-height — неподходящий вариант, тогда вполне можно привнести несемантичный лишний блок, который сделает всю грязную работу.

<div style="height: 20rem; width: 100%; background: cyan;  text-align: center;"><div style="display: inline-block; height:100%; vertical-align: middle;"></div><div style="display: inline-block; background: lightblue; padding: 0.3rem; vertical-align: middle;">отцентрируйте меня, пожалуйста</div></div>

*Этот и следующие примеры стоит рассматривать также в Developer's Tools или аналоге вашего браузера для наглядности.*

Вся соль в том, что он рендерится в потоке строки, но при этом доступны все свойства обычных блоков. Можно, например, сделать <span style="display: inline-block; padding: .3rem 1rem; border: 1px dashed black; border-radius: .3rem; background: gold; vertical-align: 0">так</span> — и никакой браузер не заругается.

С использованием инлайн-блоков также элементарно сверстать типичную подачу товаров в интернет-магазине, с которой раньше было много проблем: нужно чётко подсчитывать ширину, выводить бэкендом в специальных контейнерах специальное количество блоков с `float: left`. А если что-то пойдёт не так, то вся вёрстка разъезжается к чёрту. Инлайн-блоки делают процесс гораздо проще — можно в один контейнер накидать кучу блоков и они сами распределятся, если не влезли на одну строку — перенесутся. 

К сути:

<style>
    .sample {
        list-style: none;
    } 
    .sample-item {
        display: inline-block;
        border: 1px solid black;
        margin: 1rem;
        max-width: 11.2rem;
    }
    .sample-item img {
        display: block;
        width: 100%;
    }
    .sample-item span {
        display: inline-block;
        margin: .5rem;
    }
</style>
<ul class="sample"><!--
 --><li class="sample-item">
        <img src="http://placekitten.com/160/100">
        <span>Котейка номер раз. Очень вежливый, приучен к лотку. Любит Звёздные Войны и верстать на досуге.</span></li><!--
 --><li class="sample-item">
        <img src="http://placekitten.com/160/100">
        <span>Котейка номер два. Не такой вежливый, зато милый: расцарапает, а не жалко!</span></li><!--
 --><li class="sample-item">
        <img src="http://placekitten.com/160/100">
        <span>Котейка номер три. Если можно так сказать, чёрная лошадка среди этих котеек. Я бы даже сказал, кот в мешке!</span></li><!--
--></ul>

*Попробуйте изменить размер окна так, чтобы третий блок перенёсся на следующую строку*

С использованием инлайн-блока для подобных целей следует помнить, что он рендерится в строке. А значит, что все пробелы между элементами, которые нужны для форматирования кода <abbr title="Это стандартное поведение интерпретатора HTML, которое, впрочем, можно изменить. Нет, не только тегом <pre>">схлопываются в один</abbr>, который честно занимает своё место в строке. Эта особенность, если про неё забыть, может стоить вам получаса отладки, когда блок из-за неведомой (но только что объяснённой) магии сдвигается на два-три пикселя и съезжает в итоге вниз, например.

Столкнувшись с этой особенностью (*не баг, а фича!*), веб-технологи тут же придумали несколько вариантов решения:

<style>
ul ul {
    margin-left: 1rem;
    margin-bottom: 0.5rem;
    list-style-type: square;
}
</style>

* Не закрывать теги. Теги `<li>`, `<p>` можно не закрывать — браузер сам закроет их, когда встречает следующий `<li>` или `<p>`.
    - Плюсы: легко использовать
    - Минусы: редактор так и норовит закрыть `</li>`; не применить к другим тегам
* Не вставлять пробелов между тегами.
    - Плюсы: foolproof. Ну, почти. Применимо к любым тегам
    - Минусы: код не так красиво отформатирован в редакторе! (не имеет значения, если разметка генерируется сервером)
* Вставлять HTML-комментарии. `</div><!--куча отступов--><div>`
    - Плюсы: Применимо ко всем тегам. Мой личный фаворит.
    - Минусы: некоторым не нравятся «лишние» комментарии в коде.

Для дальнейшего рассказа потребуется ещё немного теории, налейте себе кофе.

Любой элемент на странице обернут в один из так называемых боксов. Существуют боксы инлайн-уровня, а есть блочные боксы, и напрямую рядом они не могут стоять. Так, например, если сделать `<div>Привет, <div>мир!</div>Я так рад тебя видеть</div>`, то внутренний `<div>` уедет на отдельную строку.

<div style="margin-bottom: 1rem">Привет, <div>мир!</div> Я так рад тебя видеть</div>


Так получается потому, что строки «Привет, » и «Я так рад тебя видеть» из-за соседства с внутренним `<div>` оборачиваются в анонимные боксы блочного уровня — у них нет имени и им невозможно присвоить стили: что можно наследовать, они наследуют, всё остальное становится initial. В то же время, inline-block не заставляет оборачиваться строки вокруг в такие боксы, то есть он *сохраняет контекст форматирования строки*.

Можно представить, что инлайн-блок образует просто символ с заданными размерами, и с этим связана следующая особенность, которую следует учитывать:

<div style="width:18em; background: cyan; margin-bottom: 1rem">
   Текст внутри этого спана <span>может легко разбиваться на две строки, ведь</span> это инлайновый бокс.
</div>


<style>
  .sample-span {
    display:inline-block;
  }
</style>
<div style="width:18em; background: cyan">
   Текст внутри этого span'а <span class="sample-span">не будет разбиваться на несколько строк до последнего, ведь это</span>  inline-block.
</div>

Заметили резкий обрыв первой строки? Такое поведение инлайн-блоков стоит учитывать, чтобы не возникло некрасивых переносов.

Вот, собственно, и всё, что нужно знать об инлайн-блоках, чтобы начать ими восхищаться и пользоваться.